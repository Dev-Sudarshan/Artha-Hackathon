# =============================================================================
# FACE VERIFICATION CONFIGURATION FOR 100% ACCURACY
# =============================================================================
# This file contains optimal settings for maximum face verification accuracy
# Copy to .env and adjust as needed

# -----------------------------------------------------------------------------
# Face Recognition Backend
# -----------------------------------------------------------------------------
# Options: auto, insightface, deepface
# Recommended: auto (uses insightface if available, falls back to deepface)
FACE_BACKEND=auto

# -----------------------------------------------------------------------------
# DeepFace Model Configuration
# -----------------------------------------------------------------------------
# Model for face embeddings - ArcFace is industry standard
# Options: VGG-Face, Facenet, Facenet512, OpenFace, DeepFace, DeepID, ArcFace, Dlib, SFace
# Recommended: ArcFace (best accuracy)
DEEPFACE_MODEL_NAME=ArcFace

# Detector for face detection - RetinaFace is most accurate
# Options: opencv, ssd, dlib, mtcnn, retinaface, mediapipe
# Recommended: retinaface (best accuracy, slower) or mtcnn (good balance)
DEEPFACE_DETECTOR_BACKEND=retinaface

# -----------------------------------------------------------------------------
# Face Matching Thresholds (CRITICAL FOR ACCURACY)
# -----------------------------------------------------------------------------
# Lower threshold = stricter matching = fewer false positives
# Default threshold varies by model:
# - ArcFace default: 0.68
# - For 100% accuracy in KYC: 0.40 or lower

# Threshold for KYC/identity verification (cosine distance)
# Valid range: 0.0 (exact match only) to 1.0 (any face)
# Recommended for KYC: 0.40 (maximum strictness)
KYC_FACE_THRESHOLD=0.40

# Threshold for general face matching (if using insightface)
# Valid range: 0.0 to 1.0 (similarity score)
# Recommended: 0.45
FACE_MATCH_THRESHOLD=0.45

# -----------------------------------------------------------------------------
# Face Quality Validation (NEW - FOR 100% ACCURACY)
# -----------------------------------------------------------------------------
# Minimum face detection confidence (0.0-1.0)
# Higher = only accept faces detected with high confidence
# Recommended: 0.95 for KYC
MIN_FACE_CONFIDENCE=0.95

# Minimum face sharpness (blur score via Laplacian variance)
# Higher = sharper image required
# Typical range: 50 (very blurry) to 3000+ (very sharp)
# Recommended: 200 for live selfies
MIN_FACE_SHARPNESS=200

# Maximum face sharpness (to detect professional photos)
# Professional studio photos often have scores >2000
# Recommended: 2000 to reject studio photos
MAX_FACE_SHARPNESS=2000

# -----------------------------------------------------------------------------
# Liveness Detection (ANTI-SPOOFING)
# -----------------------------------------------------------------------------
# Blur score range for live selfies (Laplacian variance)
# Real live capture: typically 200-1500
# Professional photos: typically >2000
# Printed photos: typically <200
LIVENESS_BLUR_THRESHOLD=200
LIVENESS_MAX_BLUR_THRESHOLD=1500

# Face size in frame (as ratio of image area)
# Too small = might be screenshot
# Too large = might be printed photo held close
# Recommended: 0.15-0.50 (15%-50% of image)
LIVENESS_FACE_RATIO=0.15
LIVENESS_FACE_RATIO_MAX=0.50

# Maximum head roll angle in degrees
# Smaller = more strict on head orientation
# Recommended: 12 degrees
LIVENESS_ROLL_DEG=12

# -----------------------------------------------------------------------------
# InsightFace Configuration (if using insightface backend)
# -----------------------------------------------------------------------------
# Execution providers for ONNX Runtime
# Options: CPUExecutionProvider, CUDAExecutionProvider
# Multiple providers can be specified comma-separated
INSIGHTFACE_PROVIDERS=CPUExecutionProvider

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://user:password@localhost:5432/aartha

# -----------------------------------------------------------------------------
# RECOMMENDED HARDWARE FOR 100% ACCURACY
# -----------------------------------------------------------------------------
# CPU: Modern multi-core processor (Intel i5/i7 or AMD Ryzen 5/7+)
# RAM: Minimum 8GB (16GB recommended)
# GPU: Optional but recommended for faster processing
#      - NVIDIA GPU with CUDA support
#      - Change INSIGHTFACE_PROVIDERS to CUDAExecutionProvider
# Storage: SSD recommended for faster model loading

# -----------------------------------------------------------------------------
# PERFORMANCE VS ACCURACY TRADE-OFFS
# -----------------------------------------------------------------------------
# For MAXIMUM ACCURACY (recommended for KYC):
# - DEEPFACE_DETECTOR_BACKEND=retinaface
# - KYC_FACE_THRESHOLD=0.40
# - MIN_FACE_CONFIDENCE=0.95
# - Processing time: ~2-4 seconds per verification
#
# For BALANCED (good accuracy, faster):
# - DEEPFACE_DETECTOR_BACKEND=mtcnn
# - KYC_FACE_THRESHOLD=0.45
# - MIN_FACE_CONFIDENCE=0.90
# - Processing time: ~1-2 seconds per verification
#
# For FASTEST (basic accuracy):
# - DEEPFACE_DETECTOR_BACKEND=opencv
# - KYC_FACE_THRESHOLD=0.50
# - MIN_FACE_CONFIDENCE=0.85
# - Processing time: ~0.5-1 seconds per verification

# =============================================================================
# TESTING RECOMMENDATIONS
# =============================================================================
# 1. Test with same person under different conditions:
#    - Different lighting
#    - Different angles
#    - Different times of day
#    - With/without glasses
#    - Different facial expressions
#
# 2. Test with different people who look similar:
#    - Siblings
#    - People of same ethnicity/age/gender
#
# 3. Test anti-spoofing:
#    - Printed photos
#    - Photos of photos on screen
#    - Professional ID photos
#
# 4. Adjust thresholds based on false positive/negative rates:
#    - Too many false positives? Lower KYC_FACE_THRESHOLD
#    - Too many false negatives? Raise KYC_FACE_THRESHOLD
#
# 5. Monitor verification_confidence scores:
#    - Scores >0.8 = high confidence match
#    - Scores 0.6-0.8 = medium confidence (review)
#    - Scores <0.6 = low confidence (reject)
